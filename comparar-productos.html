<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPPO by Groupe GM - Comparar Productos</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="translation-system.js"></script>
    <style>
        /* =====================================================
           ESTILOS ESPECÍFICOS PARA COMPARACIÓN MODERNA
           ===================================================== */
        
        .comparison-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
            text-align: center;
            margin-bottom: 60px;
        }
        
        .comparison-hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .comparison-hero p {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 40px;
        }
        
        .buy-button {
            display: inline-block;
            background: #007AFF;
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 122, 255, 0.3);
        }
        
        .buy-button:hover {
            background: #0056CC;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 122, 255, 0.4);
        }
        
        .product-selectors {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 60px 0;
            flex-wrap: wrap;
        }
        
        .product-selector {
            position: relative;
            min-width: 280px;
        }
        
        .selector-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .product-dropdown {
            position: relative;
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .product-dropdown:hover {
            border-color: #007AFF;
            box-shadow: 0 4px 20px rgba(0, 122, 255, 0.15);
        }
        
        .product-dropdown.active {
            border-color: #007AFF;
            box-shadow: 0 4px 20px rgba(0, 122, 255, 0.2);
        }
        
        .dropdown-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .selected-product {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .product-image-small {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            background: #f8f9fa;
        }
        
        .product-info-small {
            flex: 1;
        }
        
        .product-name-small {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
        
        .product-price-small {
            font-size: 0.9rem;
            color: #666;
            margin: 0;
        }
        
        .dropdown-arrow {
            color: #007AFF;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .product-dropdown.active .dropdown-arrow {
            transform: rotate(180deg);
        }
        
        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .dropdown-options.show {
            display: block;
        }
        
        .dropdown-option {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }
        
        .dropdown-option:hover {
            background: #f8f9fa;
        }
        
        .dropdown-option:last-child {
            border-bottom: none;
        }
        
        .option-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .option-image {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            object-fit: cover;
            background: #f8f9fa;
        }
        
        .option-info {
            flex: 1;
        }
        
        .option-name {
            font-size: 0.95rem;
            font-weight: 500;
            color: #333;
            margin: 0;
        }
        
        .option-price {
            font-size: 0.85rem;
            color: #666;
            margin: 0;
        }
        
        .product-display {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 60px 0;
            flex-wrap: wrap;
        }
        
        .product-card-display {
            text-align: center;
            max-width: 300px;
        }
        
        .product-image-large {
            width: 200px;
            height: 200px;
            border-radius: 20px;
            object-fit: cover;
            background: #f8f9fa;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .product-image-large:hover {
            transform: scale(1.05);
        }
        
        .product-name-display {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .product-price-display {
            font-size: 1.1rem;
            color: #007AFF;
            font-weight: 600;
        }
        
        .comparison-table-modern {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 60px 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .table-title {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .comparison-table th {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #e1e5e9;
        }
        
        .comparison-table td {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }
        
        .feature-label {
            font-weight: 600;
            color: #333;
            text-align: left !important;
            background: #f8f9fa;
        }
        
        .feature-value {
            font-size: 1rem;
            color: #666;
        }
        
        .feature-value .check {
            color: #27ae60;
            font-size: 1.2rem;
        }
        
        .feature-value .cross {
            color: #e74c3c;
            font-size: 1.2rem;
        }
        
        .no-data {
            color: #bdc3c7;
            font-style: italic;
        }
        
        .category-selection {
            text-align: center;
            margin: 40px 0;
        }
        
        .category-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-btn:hover {
            border-color: #007AFF;
            color: #007AFF;
        }
        
        .category-btn.active {
            background: #007AFF;
            border-color: #007AFF;
            color: white;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .empty-state i {
            font-size: 4rem;
            color: #bdc3c7;
            margin-bottom: 20px;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .empty-state p {
            font-size: 1.1rem;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .comparison-hero h1 {
                font-size: 2.5rem;
            }
            
            .product-selectors {
                flex-direction: column;
                align-items: center;
            }
            
            .product-selector {
                min-width: 250px;
            }
            
            .product-display {
                flex-direction: column;
                align-items: center;
            }
            
            .category-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .comparison-table-modern {
                padding: 20px;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span>EPPO by <span class="groupe-gm">Groupe GM</span></span>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="productos-dinamico.html" class="nav-link">Products</a>
                <a href="comparar-productos.html" class="nav-link">Comparar</a>
                <a href="carrito-compras.html" class="nav-link">Carrito</a>
                <div class="language-selector">
                    <button class="flag-btn active" data-lang="pt" title="Português" onclick="changeLanguage('pt')">
                        <img src="https://flagcdn.com/w20/pt.png" alt="Portugal">
                    </button>
                    <button class="flag-btn" data-lang="es" title="Español" onclick="changeLanguage('es')">
                        <img src="https://flagcdn.com/w20/es.png" alt="España">
                    </button>
                    <button class="flag-btn" data-lang="en" title="English" onclick="changeLanguage('en')">
                        <img src="https://flagcdn.com/w20/gb.png" alt="Reino Unido">
                    </button>
                </div>
                <button class="theme-toggle" id="theme-toggle" title="Cambiar tema">
                    <i class="fas fa-sun sun-icon"></i>
                    <i class="fas fa-moon moon-icon"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="comparison-hero">
        <div class="container">
            <h1 id="heroTitle">Compare modelos de Secadores</h1>
            <p id="heroSubtitle">Encuentra el secador perfecto para tu hotel</p>
            <a href="productos-dinamico.html" class="buy-button">
                <i class="fas fa-shopping-cart"></i>
                Compre o Secador >
            </a>
        </div>
    </section>

    <!-- Category Selection -->
    <div class="category-selection">
        <div class="container">
            <div class="category-buttons" id="categoryButtons">
                <!-- Se llenará dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Product Selectors -->
    <div class="product-selectors" id="productSelectors" style="display: none;">
        <div class="product-selector">
            <div class="selector-label">Secador 1</div>
            <div class="product-dropdown" onclick="toggleDropdown(0)">
                <div class="dropdown-content">
                    <div class="selected-product" id="selectedProduct0">
                        <img src="secador.png" alt="Seleccionar" class="product-image-small">
                        <div class="product-info-small">
                            <h4 class="product-name-small">Seleccionar Secador</h4>
                            <p class="product-price-small">-</p>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>
                <div class="dropdown-options" id="dropdownOptions0">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </div>

        <div class="product-selector">
            <div class="selector-label">Secador 2</div>
            <div class="product-dropdown" onclick="toggleDropdown(1)">
                <div class="dropdown-content">
                    <div class="selected-product" id="selectedProduct1">
                        <img src="secador.png" alt="Seleccionar" class="product-image-small">
                        <div class="product-info-small">
                            <h4 class="product-name-small">Seleccionar Secador</h4>
                            <p class="product-price-small">-</p>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>
                <div class="dropdown-options" id="dropdownOptions1">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </div>

        <div class="product-selector">
            <div class="selector-label">Secador 3</div>
            <div class="product-dropdown" onclick="toggleDropdown(2)">
                <div class="dropdown-content">
                    <div class="selected-product" id="selectedProduct2">
                        <img src="secador.png" alt="Seleccionar" class="product-image-small">
                        <div class="product-info-small">
                            <h4 class="product-name-small">Seleccionar Secador</h4>
                            <p class="product-price-small">-</p>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>
                <div class="dropdown-options" id="dropdownOptions2">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Product Display -->
    <div class="product-display" id="productDisplay" style="display: none;">
        <!-- Se llenará dinámicamente -->
    </div>

    <!-- Comparison Table -->
    <div class="comparison-table-modern" id="comparisonTable" style="display: none;">
        <h2 class="table-title">Comparação de Especificações</h2>
        <table class="comparison-table" id="comparisonTableContent">
            <!-- Se llenará dinámicamente -->
        </table>
    </div>

    <!-- Empty State -->
    <div class="empty-state" id="emptyState">
        <i class="fas fa-balance-scale"></i>
        <h3>Seleccione una categoría para comenzar</h3>
        <p>Elija una categoría de productos para ver las opciones de comparación</p>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 EPPO by Groupe GM. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // =====================================================
        // SISTEMA DE COMPARACIÓN MODERNO
        // =====================================================
        
        class ModernProductComparison {
            constructor() {
                this.currentLanguage = 'pt';
                this.currentCategory = null;
                this.availableProducts = [];
                this.selectedProducts = [null, null, null]; // 3 slots para productos
                this.supabase = null;
                
                this.init();
            }
            
            async init() {
                await this.initSupabase();
                this.setupLanguageSelector();
                this.setupCategoryButtons();
                this.loadTranslations();
                this.updateLanguageUI();
            }
            
            async initSupabase() {
                try {
                    const supabaseUrl = 'https://fzlvsgjvilompkjmqeoj.supabase.co';
                    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ6bHZzZ2p2aWxvbXBram1xZW9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzNjQyODYsImV4cCI6MjA3Mzk0MDI4Nn0.KbH8qLOoWrVeXcTHelQNIzXoz0tutVGJHqkYw3GPFPY';
                    
                    this.supabase = supabase.createClient(supabaseUrl, supabaseKey);
                    console.log('✅ Supabase inicializado correctamente');
                } catch (error) {
                    console.error('❌ Error inicializando Supabase:', error);
                }
            }
            
            setupLanguageSelector() {
                this.currentLanguage = document.documentElement.lang || 'pt';
            }
            
            setupCategoryButtons() {
                const categories = [
                    { id: 'secadores', name: 'Secadores', icon: 'wind' },
                    { id: 'ironing', name: 'Planchas', icon: 'tshirt' },
                    { id: 'porta-malas', name: 'Porta Malas', icon: 'suitcase' }
                ];
                
                const container = document.getElementById('categoryButtons');
                container.innerHTML = categories.map(category => `
                    <button class="category-btn" onclick="comparison.selectCategory('${category.id}')">
                        <i class="fas fa-${category.icon}"></i>
                        <span>${category.name}</span>
                    </button>
                `).join('');
            }
            
            async selectCategory(categoryId) {
                this.currentCategory = categoryId;
                this.selectedProducts = [null, null, null];
                
                // Actualizar botones de categoría
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.closest('.category-btn').classList.add('active');
                
                // Mostrar selectores de productos
                document.getElementById('productSelectors').style.display = 'flex';
                document.getElementById('emptyState').style.display = 'none';
                
                // Cargar productos de la categoría
                await this.loadCategoryProducts(categoryId);
                
                // Actualizar hero section
                this.updateHeroSection(categoryId);
            }
            
            updateHeroSection(categoryId) {
                const titles = {
                    'secadores': {
                        pt: 'Compare modelos de Secadores',
                        es: 'Compare modelos de Secadores',
                        en: 'Compare Hair Dryer Models'
                    },
                    'ironing': {
                        pt: 'Compare modelos de Planchas',
                        es: 'Compare modelos de Planchas',
                        en: 'Compare Iron Models'
                    },
                    'porta-malas': {
                        pt: 'Compare modelos de Porta Malas',
                        es: 'Compare modelos de Porta Malas',
                        en: 'Compare Suitcase Models'
                    }
                };
                
                const subtitles = {
                    'secadores': {
                        pt: 'Encontre o secador perfeito para seu hotel',
                        es: 'Encuentra el secador perfecto para tu hotel',
                        en: 'Find the perfect hair dryer for your hotel'
                    },
                    'ironing': {
                        pt: 'Encontre a plancha perfeita para seu hotel',
                        es: 'Encuentra la plancha perfecta para tu hotel',
                        en: 'Find the perfect iron for your hotel'
                    },
                    'porta-malas': {
                        pt: 'Encontre o porta malas perfeito para seu hotel',
                        es: 'Encuentra el porta malas perfecto para tu hotel',
                        en: 'Find the perfect suitcase for your hotel'
                    }
                };
                
                document.getElementById('heroTitle').textContent = titles[categoryId][this.currentLanguage];
                document.getElementById('heroSubtitle').textContent = subtitles[categoryId][this.currentLanguage];
            }
            
            async loadCategoryProducts(categoryId) {
                try {
                    // Mapear categorías a tablas
                    const tableMap = {
                        'secadores': 'secadores',
                        'ironing': 'ironing', 
                        'porta-malas': 'porta_malas'
                    };
                    
                    const tableName = tableMap[categoryId] || categoryId;
                    const { data, error } = await this.supabase
                        .from(tableName)
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) throw error;
                    
                    this.availableProducts = data || [];
                    this.populateDropdowns();
                    
                } catch (error) {
                    console.error('Error cargando productos:', error);
                    this.showError('Error cargando productos de la categoría');
                }
            }
            
            populateDropdowns() {
                for (let i = 0; i < 3; i++) {
                    const dropdown = document.getElementById(`dropdownOptions${i}`);
                    dropdown.innerHTML = this.availableProducts.map(product => `
                        <div class="dropdown-option" onclick="comparison.selectProduct(${i}, ${product.id})">
                            <div class="option-content">
                                <img src="${product.foto}" alt="${product.nombre}" class="option-image" onerror="this.src='secador.png'">
                                <div class="option-info">
                                    <h4 class="option-name">${product.nombre}</h4>
                                    <p class="option-price">€${product.precio}</p>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            }
            
            selectProduct(slotIndex, productId) {
                const product = this.availableProducts.find(p => p.id === productId);
                if (!product) return;
                
                this.selectedProducts[slotIndex] = product;
                this.updateSelectedProductDisplay(slotIndex, product);
                this.updateProductDisplay();
                this.updateComparisonTable();
                this.closeDropdown(slotIndex);
            }
            
            updateSelectedProductDisplay(slotIndex, product) {
                const selectedProduct = document.getElementById(`selectedProduct${slotIndex}`);
                selectedProduct.innerHTML = `
                    <img src="${product.foto}" alt="${product.nombre}" class="product-image-small" onerror="this.src='secador.png'">
                    <div class="product-info-small">
                        <h4 class="product-name-small">${product.nombre}</h4>
                        <p class="product-price-small">€${product.precio}</p>
                    </div>
                `;
            }
            
            updateProductDisplay() {
                const container = document.getElementById('productDisplay');
                const hasSelectedProducts = this.selectedProducts.some(p => p !== null);
                
                if (!hasSelectedProducts) {
                    container.style.display = 'none';
                    return;
                }
                
                container.style.display = 'flex';
                container.innerHTML = this.selectedProducts.map((product, index) => {
                    if (!product) {
                        return `
                            <div class="product-card-display">
                                <div class="product-image-large" style="background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #bdc3c7;">
                                    <i class="fas fa-plus" style="font-size: 3rem;"></i>
                                </div>
                                <h3 class="product-name-display">Seleccionar ${this.getCategoryName()}</h3>
                                <p class="product-price-display">-</p>
                            </div>
                        `;
                    }
                    
                    return `
                        <div class="product-card-display">
                            <img src="${product.foto}" alt="${product.nombre}" class="product-image-large" onerror="this.src='secador.png'">
                            <h3 class="product-name-display">${product.nombre}</h3>
                            <p class="product-price-display">€${product.precio}</p>
                        </div>
                    `;
                }).join('');
            }
            
            getCategoryName() {
                const names = {
                    'secadores': { pt: 'Secador', es: 'Secador', en: 'Hair Dryer' },
                    'ironing': { pt: 'Plancha', es: 'Plancha', en: 'Iron' },
                    'porta-malas': { pt: 'Porta Malas', es: 'Porta Malas', en: 'Suitcase' }
                };
                return names[this.currentCategory][this.currentLanguage];
            }
            
            updateComparisonTable() {
                const container = document.getElementById('comparisonTable');
                const table = document.getElementById('comparisonTableContent');
                const hasSelectedProducts = this.selectedProducts.some(p => p !== null);
                
                if (!hasSelectedProducts) {
                    container.style.display = 'none';
                    return;
                }
                
                container.style.display = 'block';
                
                // Crear tabla de comparación
                let tableHTML = `
                    <thead>
                        <tr>
                            <th class="feature-label">Característica</th>
                            ${this.selectedProducts.map((product, index) => `
                                <th class="product-column">
                                    ${product ? `
                                        <img src="${product.foto}" alt="${product.nombre}" style="width: 60px; height: 60px; border-radius: 8px; object-fit: cover; margin-bottom: 10px;" onerror="this.src='secador.png'">
                                        <h4 style="margin: 0; font-size: 1rem;">${product.nombre}</h4>
                                        <div style="color: #007AFF; font-weight: 600; margin-top: 5px;">€${product.precio}</div>
                                    ` : `
                                        <div style="color: #bdc3c7; font-style: italic;">No seleccionado</div>
                                    `}
                                </th>
                            `).join('')}
                        </tr>
                    </thead>
                    <tbody>
                `;
                
                // Agregar filas de comparación según la categoría
                if (this.currentCategory === 'secadores') {
                    tableHTML += this.createSecadoresComparisonRows();
                } else if (this.currentCategory === 'ironing') {
                    tableHTML += this.createIroningComparisonRows();
                } else if (this.currentCategory === 'porta-malas') {
                    tableHTML += this.createPortaMalasComparisonRows();
                }
                
                tableHTML += '</tbody>';
                table.innerHTML = tableHTML;
            }
            
            createSecadoresComparisonRows() {
                const rows = [
                    { label: { pt: 'Potência', es: 'Potencia', en: 'Power' }, key: 'potencia', unit: 'W' },
                    { label: { pt: 'Voltagem', es: 'Voltaje', en: 'Voltage' }, key: 'voltaje', unit: 'V' },
                    { label: { pt: 'Cor', es: 'Color', en: 'Color' }, key: 'color' },
                    { label: { pt: 'Tipo de Instalação', es: 'Tipo de Instalación', en: 'Installation Type' }, key: 'tipo_instalacion' },
                    { label: { pt: 'Velocidades', es: 'Velocidades', en: 'Speeds' }, key: 'velocidades' },
                    { label: { pt: 'Níveis de Calor', es: 'Niveles de Calor', en: 'Heat Levels' }, key: 'niveles_calor' },
                    { label: { pt: 'Tecnologia Iônica', es: 'Tecnología Iónica', en: 'Ionic Technology' }, key: 'tecnologia_ionica', type: 'boolean' },
                    { label: { pt: 'Tecnologia Cerâmica', es: 'Tecnología Cerámica', en: 'Ceramic Technology' }, key: 'tecnologia_ceramica', type: 'boolean' },
                    { label: { pt: 'Peso', es: 'Peso', en: 'Weight' }, key: 'peso', unit: 'kg' },
                    { label: { pt: 'Dimensões', es: 'Dimensiones', en: 'Dimensions' }, key: 'dimensiones' },
                    { label: { pt: 'Plegável', es: 'Plegable', en: 'Foldable' }, key: 'plegable', type: 'boolean' }
                ];
                
                return rows.map(row => `
                    <tr>
                        <td class="feature-label">${row.label[this.currentLanguage] || row.label.pt}</td>
                        ${this.selectedProducts.map(product => `
                            <td class="feature-value">
                                ${product ? this.formatFeatureValue(product[row.key], row.type, row.unit) : '<span class="no-data">-</span>'}
                            </td>
                        `).join('')}
                    </tr>
                `).join('');
            }
            
            createIroningComparisonRows() {
                const rows = [
                    { label: { pt: 'Potência', es: 'Potencia', en: 'Power' }, key: 'potencia', unit: 'W' },
                    { label: { pt: 'Tipo de Ferro', es: 'Tipo de Plancha', en: 'Iron Type' }, key: 'tipo_plancha' },
                    { label: { pt: 'Pressão de Vapor', es: 'Presión de Vapor', en: 'Steam Pressure' }, key: 'presion_vapor', unit: 'g/min' },
                    { label: { pt: 'Depósito de Água', es: 'Depósito de Agua', en: 'Water Tank' }, key: 'deposito_agua', unit: 'L' },
                    { label: { pt: 'Peso', es: 'Peso', en: 'Weight' }, key: 'peso', unit: 'kg' }
                ];
                
                return rows.map(row => `
                    <tr>
                        <td class="feature-label">${row.label[this.currentLanguage] || row.label.pt}</td>
                        ${this.selectedProducts.map(product => `
                            <td class="feature-value">
                                ${product ? this.formatFeatureValue(product[row.key], row.type, row.unit) : '<span class="no-data">-</span>'}
                            </td>
                        `).join('')}
                    </tr>
                `).join('');
            }
            
            createPortaMalasComparisonRows() {
                const rows = [
                    { label: { pt: 'Capacidade', es: 'Capacidad', en: 'Capacity' }, key: 'capacidad', unit: 'L' },
                    { label: { pt: 'Material', es: 'Material', en: 'Material' }, key: 'tipo_material' },
                    { label: { pt: 'Estrutura', es: 'Estructura', en: 'Structure' }, key: 'tipo_estructura' },
                    { label: { pt: 'Número de Rodas', es: 'Número de Ruedas', en: 'Number of Wheels' }, key: 'numero_ruedas' },
                    { label: { pt: 'Peso', es: 'Peso', en: 'Weight' }, key: 'peso', unit: 'kg' },
                    { label: { pt: 'Dimensões', es: 'Dimensiones', en: 'Dimensions' }, key: 'dimensiones' }
                ];
                
                return rows.map(row => `
                    <tr>
                        <td class="feature-label">${row.label[this.currentLanguage] || row.label.pt}</td>
                        ${this.selectedProducts.map(product => `
                            <td class="feature-value">
                                ${product ? this.formatFeatureValue(product[row.key], row.type, row.unit) : '<span class="no-data">-</span>'}
                            </td>
                        `).join('')}
                    </tr>
                `).join('');
            }
            
            formatFeatureValue(value, type, unit) {
                if (value === null || value === undefined || value === '') {
                    return '<span class="no-data">-</span>';
                }
                
                if (type === 'boolean') {
                    return value ? '<i class="fas fa-check check"></i>' : '<i class="fas fa-times cross"></i>';
                }
                
                if (unit) {
                    return `${value} ${unit}`;
                }
                
                return value;
            }
            
            loadTranslations() {
                this.translations = {
                    pt: {
                        compareProducts: 'Comparar Productos',
                        compareSubtitle: 'Compare as características técnicas de diferentes produtos',
                        selectCategory: 'Selecionar Categoria',
                        selectProducts: 'Selecionar Produtos para Comparar',
                        comparisonTable: 'Tabela de Comparação',
                        clearComparison: 'Limpar Comparação',
                        selectedProducts: 'Produtos Selecionados',
                        addToCompare: 'Adicionar à Comparação',
                        added: 'Adicionado',
                        feature: 'Característica'
                    },
                    es: {
                        compareProducts: 'Comparar Productos',
                        compareSubtitle: 'Compare las características técnicas de diferentes productos',
                        selectCategory: 'Seleccionar Categoría',
                        selectProducts: 'Seleccionar Productos para Comparar',
                        comparisonTable: 'Tabla de Comparación',
                        clearComparison: 'Limpiar Comparación',
                        selectedProducts: 'Productos Seleccionados',
                        addToCompare: 'Agregar a Comparación',
                        added: 'Agregado',
                        feature: 'Característica'
                    },
                    en: {
                        compareProducts: 'Compare Products',
                        compareSubtitle: 'Compare technical characteristics of different products',
                        selectCategory: 'Select Category',
                        selectProducts: 'Select Products to Compare',
                        comparisonTable: 'Comparison Table',
                        clearComparison: 'Clear Comparison',
                        selectedProducts: 'Selected Products',
                        addToCompare: 'Add to Comparison',
                        added: 'Added',
                        feature: 'Feature'
                    }
                };
            }
            
            updateLanguageUI() {
                // Actualizar traducciones si es necesario
            }
            
            showError(message) {
                console.error(message);
                alert(message);
            }
        }
        
        // =====================================================
        // FUNCIONES GLOBALES
        // =====================================================
        
        let comparison;
        
        function changeLanguage(lang) {
            document.documentElement.lang = lang;
            comparison.currentLanguage = lang;
            comparison.updateLanguageUI();
            
            // Actualizar banderas activas
            document.querySelectorAll('.flag-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
            
            if (comparison.currentCategory) {
                comparison.updateHeroSection(comparison.currentCategory);
                comparison.updateComparisonTable();
            }
        }
        
        function toggleDropdown(index) {
            const dropdown = document.querySelectorAll('.product-dropdown')[index];
            const options = document.getElementById(`dropdownOptions${index}`);
            
            // Cerrar otros dropdowns
            document.querySelectorAll('.product-dropdown').forEach((d, i) => {
                if (i !== index) {
                    d.classList.remove('active');
                    document.getElementById(`dropdownOptions${i}`).classList.remove('show');
                }
            });
            
            // Toggle current dropdown
            dropdown.classList.toggle('active');
            options.classList.toggle('show');
        }
        
        function closeDropdown(index) {
            const dropdown = document.querySelectorAll('.product-dropdown')[index];
            const options = document.getElementById(`dropdownOptions${index}`);
            dropdown.classList.remove('active');
            options.classList.remove('show');
        }
        
        // Cerrar dropdowns al hacer click fuera
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.product-dropdown')) {
                document.querySelectorAll('.product-dropdown').forEach((dropdown, index) => {
                    dropdown.classList.remove('active');
                    document.getElementById(`dropdownOptions${index}`).classList.remove('show');
                });
            }
        });
        
        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            comparison = new ModernProductComparison();
        });
    </script>
    
    <script>
        // Función para manejar el cambio de tema
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Actualizar el título del botón
            const toggleButton = document.getElementById('theme-toggle');
            toggleButton.setAttribute('title', newTheme === 'dark' ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
        }

        // Función para inicializar el tema
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            document.documentElement.setAttribute('data-theme', theme);
            
            const toggleButton = document.getElementById('theme-toggle');
            toggleButton.setAttribute('title', theme === 'dark' ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            
            const toggleButton = document.getElementById('theme-toggle');
            if (toggleButton) {
                toggleButton.addEventListener('click', toggleTheme);
            }
        });

        // Escuchar cambios en las preferencias del sistema
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (!localStorage.getItem('theme')) {
                const theme = e.matches ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', theme);
            }
        });
    </script>
</body>
</html>