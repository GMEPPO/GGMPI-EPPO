<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPPO by Groupe GM - Productos Dinámicos</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="translation-system.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span>EPPO by <span class="groupe-gm">Groupe GM</span></span>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="productos-dinamico.html" class="nav-link">Products</a>
                <a href="comparar-productos.html" class="nav-link">Comparar</a>
                <a href="carrito-compras.html" class="nav-link">Carrito</a>
                <div class="language-selector">
                    <button class="flag-btn active" data-lang="pt" title="Português" onclick="changeLanguage('pt')">
                        <img src="https://flagcdn.com/w20/pt.png" alt="Portugal">
                    </button>
                    <button class="flag-btn" data-lang="es" title="Español" onclick="changeLanguage('es')">
                        <img src="https://flagcdn.com/w20/es.png" alt="España">
                    </button>
                    <button class="flag-btn" data-lang="en" title="English" onclick="changeLanguage('en')">
                        <img src="https://flagcdn.com/w20/gb.png" alt="Reino Unido">
                    </button>
                </div>
                <button class="theme-toggle" id="theme-toggle" title="Cambiar tema">
                    <i class="fas fa-sun sun-icon"></i>
                    <i class="fas fa-moon moon-icon"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="products-main">
        <div class="products-container">
            <!-- Sidebar de filtros -->
            <aside class="card" style="padding:20px; position:sticky; top:90px;">
                <h3 id="filters-title" style="font-family:'Playfair Display',serif;color:var(--brand-blue);margin:0 0 12px;">Filtros</h3>
                
                <!-- Filtro de Categorías -->
                <div class="filter-section">
                    <h4 id="categories-title" class="filter-title">Categorias</h4>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" value="secadores" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-wind"></i>
                            <span id="secadores-label">Secadores</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" value="ironing">
                            <span class="checkmark"></span>
                            <i class="fas fa-tshirt"></i>
                            <span id="ironing-label">Passar a ferro</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" value="porta-malas">
                            <span class="checkmark"></span>
                            <i class="fas fa-suitcase"></i>
                            <span id="porta-malas-label">Porta-malas</span>
                        </label>
                    </div>
                </div>

                <!-- Filtro de Precio -->
                <div class="filter-section">
                    <h4 id="price-title" class="filter-title">Preço</h4>
                    <div class="price-range">
                        <input type="range" id="priceSlider" min="0" max="200" value="200" class="range-slider">
                        <div class="price-display">
                            <span id="priceValue">Até €200</span>
                        </div>
                    </div>
                </div>

                <!-- Filtro de Potencia -->
                <div class="filter-section" id="powerFilter">
                    <h4 id="power-title" class="filter-title">Potência</h4>
                    <div class="filter-options" id="powerOptions">
                        <!-- Se llena dinámicamente según la categoría seleccionada -->
                    </div>
                </div>

                <!-- Filtro de Color -->
                <div class="filter-section" id="colorFilter">
                    <h4 id="color-title" class="filter-title">Cor</h4>
                    <div class="color-options" id="colorOptions">
                        <!-- Se llena dinámicamente según la categoría seleccionada -->
                    </div>
                </div>

                <!-- Filtro de Tipo (Dinámico) -->
                <div class="filter-section" id="typeFilter">
                    <h4 id="type-title" class="filter-title">Tipo</h4>
                    <div class="filter-options" id="typeOptions">
                        <!-- Se llenará dinámicamente según las categorías seleccionadas -->
                    </div>
                </div>

                <!-- Filtro de Tecnología (Solo para Secadores) -->
                <div class="filter-section" id="technologyFilter">
                    <h4 id="technology-title" class="filter-title">Tecnologia</h4>
                    <div class="filter-options" id="technologyOptions">
                        <!-- Se llena dinámicamente solo para secadores -->
                    </div>
                </div>

                <!-- Botones de acción -->
                <div class="filter-actions">
                    <button class="btn-clear" id="clearFilters">Limpar Filtros</button>
                    <button class="btn-apply" id="applyFilters">Aplicar Filtros</button>
                </div>
            </aside>

            <!-- Contenido principal de productos -->
            <section class="products-content">
                <div class="products-header">
                    <h1 class="products-title">Cargando productos...</h1>
                    <p class="products-subtitle">Por favor espera mientras cargamos los productos</p>
                </div>

                <div class="products-grid" id="products-grid">
                    <!-- Los productos se cargarán dinámicamente aquí -->
                </div>
            </section>
        </div>
    </main>

    <script src="productos-dinamico-supabase.js"></script>
    <script src="carrito-compras.js"></script>
    
    <script>
        // Función para manejar el cambio de tema
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Actualizar el título del botón
            const toggleButton = document.getElementById('theme-toggle');
            toggleButton.setAttribute('title', newTheme === 'dark' ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
        }

        // Función para inicializar el tema
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            document.documentElement.setAttribute('data-theme', theme);
            
            const toggleButton = document.getElementById('theme-toggle');
            toggleButton.setAttribute('title', theme === 'dark' ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
        }

        // Función para traducir los filtros
        function translateFilters(lang) {
            const translations = {
                pt: {
                    filters: 'Filtros',
                    categories: 'Categorias',
                    price: 'Preço',
                    power: 'Potência',
                    color: 'Cor',
                    type: 'Tipo',
                    technology: 'Tecnologia',
                    secadores: 'Secadores',
                    ironing: 'Passar a ferro',
                    portamaletas: 'Porta-malas',
                    clearFilters: 'Limpar Filtros',
                    applyFilters: 'Aplicar Filtros',
                    upTo: 'Até'
                },
                es: {
                    filters: 'Filtros',
                    categories: 'Categorías',
                    price: 'Precio',
                    power: 'Potencia',
                    color: 'Color',
                    type: 'Tipo',
                    technology: 'Tecnología',
                    secadores: 'Secadores',
                    ironing: 'Planchado',
                    portamaletas: 'Portamaletas',
                    clearFilters: 'Limpiar Filtros',
                    applyFilters: 'Aplicar Filtros',
                    upTo: 'Hasta'
                },
                en: {
                    filters: 'Filters',
                    categories: 'Categories',
                    price: 'Price',
                    power: 'Power',
                    color: 'Color',
                    type: 'Type',
                    technology: 'Technology',
                    secadores: 'Hair Dryers',
                    ironing: 'Ironing',
                    portamaletas: 'Luggage Racks',
                    clearFilters: 'Clear Filters',
                    applyFilters: 'Apply Filters',
                    upTo: 'Up to'
                }
            };

            const t = translations[lang] || translations.pt;

            // Traducir títulos de filtros
            const elements = {
                'filters-title': t.filters,
                'categories-title': t.categories,
                'price-title': t.price,
                'power-title': t.power,
                'color-title': t.color,
                'type-title': t.type,
                'technology-title': t.technology,
                'secadores-label': t.secadores,
                'ironing-label': t.ironing,
                'porta-malas-label': t.portamaletas
            };

            // Aplicar traducciones
            Object.entries(elements).forEach(([id, text]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = text;
                }
            });

            // Traducir botones
            const clearButton = document.getElementById('clearFilters');
            const applyButton = document.getElementById('applyFilters');
            if (clearButton) clearButton.textContent = t.clearFilters;
            if (applyButton) applyButton.textContent = t.applyFilters;

            // Traducir valor del precio
            const priceValue = document.getElementById('priceValue');
            if (priceValue) {
                const currentValue = document.getElementById('priceSlider')?.value || '200';
                priceValue.textContent = `${t.upTo} €${currentValue}`;
            }
        }

        // Función para cambiar idioma
        function changeLanguage(lang) {
            document.documentElement.lang = lang;
            localStorage.setItem('language', lang);
            
            // Actualizar banderas activas
            document.querySelectorAll('.flag-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
            
            // Traducir filtros
            translateFilters(lang);
            
            // Actualizar sistema de traducción global
            if (window.translationSystem) {
                window.translationSystem.setLanguage(lang);
            }
            
            // Actualizar productos si el manager está disponible
            if (window.productManager) {
                window.productManager.changeLanguage(lang);
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            
            const toggleButton = document.getElementById('theme-toggle');
            if (toggleButton) {
                toggleButton.addEventListener('click', toggleTheme);
            }

            // Inicializar idioma
            const savedLanguage = localStorage.getItem('language') || 'pt';
            changeLanguage(savedLanguage);
        });

        // Escuchar cambios en las preferencias del sistema
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (!localStorage.getItem('theme')) {
                const theme = e.matches ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', theme);
            }
        });
    </script>
</body>
</html>


